# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## –ü—Ä–æ–±–ª–µ–º–∞ –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ —Ä–µ—à–µ–Ω–∞

**–û—à–∏–±–∫–∞:** `Field 'team_id' doesn't have a default value`

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É —Å—Ç–∞—Ä—ã–º–∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –∏ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

- **–¢–∞–±–ª–∏—Ü–∞ `teams`** —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–∞—è (id, name, timestamps)
- **–¢–∞–±–ª–∏—Ü–∞ `team_players`** —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ –∏–≥—Ä–æ–∫–∞–º–∏
- –£–±—Ä–∞–Ω–∞ –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–ª–µ–π `player1_id`, `player2_id` –∏ —Ç.–¥.

### 2. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π

- **`migrate.ts`** —Ç–µ–ø–µ—Ä—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ë–î –¥–µ–ª–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `init-database.sql`
- –°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å—Ç–∞—Ä—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π –≤ `migrate-old.ts`

### 3. –°–æ–∑–¥–∞–Ω—ã —Ñ–∞–π–ª—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

- **`init-database.sql`** - –ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –Ω–æ–≤—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫
- **`mysql/init/01-init.sql`** - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è Docker

## üîß –î–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ù–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# 2. –£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ MySQL (–±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∞ –ë–î)
docker volume rm petanque_mysql_data

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
docker-compose up -d
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î

```bash
# 1. –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
docker exec petanque-mysql mysqldump -u root -proot_password petanque_rating > backup.sql

# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
docker exec -i petanque-mysql mysql -u root -proot_password petanque_rating < init-database.sql

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π
cd backend && npm run migrate
```

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü
SHOW TABLES;
DESCRIBE teams;
DESCRIBE team_players;
DESCRIBE tournament_results;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
SELECT COUNT(*) FROM teams;
SELECT COUNT(*) FROM team_players;
SELECT COUNT(*) FROM tournament_results;
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

### –î–æ (—Å—Ç–∞—Ä–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):

```sql
CREATE TABLE teams (
  id INT,
  player1_id INT NOT NULL,
  player2_id INT,
  player3_id INT,
  player4_id INT,
  tournament_id INT  -- –∫–æ–º–∞–Ω–¥—ã –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —Ç—É—Ä–Ω–∏—Ä–∞–º
);
```

### –ü–æ—Å–ª–µ (–Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):

```sql
-- –ö–æ–º–∞–Ω–¥—ã —Ç–µ–ø–µ—Ä—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ
CREATE TABLE teams (
  id INT PRIMARY KEY,
  name VARCHAR(255)
);

-- –ò–≥—Ä–æ–∫–∏ —Å–≤—è–∑–∞–Ω—ã —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
CREATE TABLE team_players (
  team_id INT,
  player_id INT,
  position TINYINT
);
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å:** –ö–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—Ç 1 –¥–æ 4 –∏–≥—Ä–æ–∫–æ–≤  
‚úÖ **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –º–æ–∂–µ—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–∞—Ö  
‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞:** –£–±—Ä–∞–Ω–∞ –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–ª–µ–π  
‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ –≤ –∫–æ–º–∞–Ω–¥—É

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ `team_id doesn't have default value`:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é migrate.ts:**

   ```bash
   head -5 backend/src/migrations/migrate.ts
   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "–ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Å —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ë–î"
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î:**

   ```sql
   DESCRIBE tournament_results;
   -- –ü–æ–ª–µ team_id –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å NOT NULL –±–µ–∑ DEFAULT
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:**
   ```bash
   docker-compose logs backend
   ```

### –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ—Ç–µ—Ä—è–Ω—ã:

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
docker exec -i petanque-mysql mysql -u root -proot_password petanque_rating < backup.sql
```

## üìû –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î —á–µ—Ä–µ–∑ phpMyAdmin –∏–ª–∏ MySQL –∫–ª–∏–µ–Ω—Ç
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤—ã–π `migrate.ts`, –∞ –Ω–µ —Å—Ç–∞—Ä—ã–π

---

‚ú® **–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö!**
