#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
Скрипт для создания Excel файла лицензионных игроков петанка на основе данных с сайта petanque.ru
"""

import openpyxl
from datetime import datetime

# Данные лицензионных игроков 2025 г. по состоянию на 01.07.2025 г.
# Структура: № п/п, ФИО, Дата, № лицензии, Город
players_data = [
    [1, "Абакумова Дарья", "6.17.2025", "422", "Приозерск"],
    [2, "Агапов Александр", "3.25.2025", "191", "Москва"],
    [3, "Аймен Саиди", "5.1.2025", "417", "Н. Новгород"],
    [4, "Акулова Александра", "5.8.2025", "419", "Анапа"],
    [5, "Алиева Ольга", "1.13.2025", "404", "Питер"],
    [6, "Алкина Светлана", "1.25.2025", "233", "Калуга"],
    [7, "Анухин Виктор", "1.12.2025", "85", "Питер"],
    [8, "Артюхина Елена", "1.18.2025", "25", "Москва"],
    [9, "Африканов Андрей", "1.12.2025", "316", "Питер"],
    [10, "Багаутдинова Гульназ", "1.12.2025", "375", "Питер"],
    [11, "Базарев Дмитрий", "5.17.2025", "262", "Москва"],
    [12, "Бакар Риад", "3.25.2025", "396", "Москва"],
    [13, "Балахтин Илья (юниор)", "1.12.2025", "410", "Питер"],
    [14, "Банщиков Андрей", "1.25.2025", "236", "Калуга"],
    [15, "Баринова Светлана", "1.25.2025", "101", "Калуга"],
    [16, "Бейгер Максим", "1.18.2025", "331", "Москва"],
    [17, "Березнеговская Светлана", "1.18.2025", "332", "Калуга"],
    [18, "Бирюкова Наталья", "1.23.2025", "180", "Москва"],
    [19, "Большаков Василий", "1.8.2025", "380", "Приозерск"],
    [20, "Большаков Михаил (юниор)", "1.8.2025", "382", "Приозерск"],
    [21, "Большакова Мария", "1.8.2025", "381", "Приозерск"],
    [22, "Бублик Татьяна", "2.1.2025", "282", "Десногорск"],
    [23, "Бугите Юлия", "1.25.2025", "389", "Калуга"],
    [24, "Вахрушев Владимир", "1.18.2025", "329", "Москва"],
    [25, "Волков Денис", "1.22.2025", "289", "Москва"],
    [26, "Воробьева Лиза", "1.18.2025", "361", "Москва"],
    [27, "Воронов Олег", "1.25.2025", "281", "Москва"],
    [28, "Гаджиев Сеявуш", "1.19.2025", "239", "Москва"],
    [29, "Гаркавый Вадим", "1.8.2025", "384", "Приозерск"],
    [30, "Гелдиев Роман", "5.31.2025", "305", "Новороссийск"],
    [31, "Глеклер Андрей", "1.25.2025", "411", "Калуга"],
    [32, "Глуховский Аркадий", "1.6.2025", "392", "Москва"],
    [33, "Головко Татьяна", "1.6.2025", "391", "Москва"],
    [34, "Гоцфрид Константин", "1.25.2025", "34", "Калуга"],
    [35, "Гришин Дмитрий", "1.17.2025", "409", "Питер"],
    [36, "Гришков Сергей", "1.18.2025", "61", "Сафоново"],
    [37, "Гулинин Евгений", "1.19.2025", "105", "Москва"],
    [38, "Денисов Евгений", "1.19.2025", "272", "Москва"],
    [39, "Джедиан Нуредин", "1.18.2025", "395", "Франция"],
    [40, "Догадин Евгений", "2.8.2025", "144", "Смоленск"],
    [41, "Домбровская Анна", "3.25.2025", "413", "Питер"],
    [42, "Домбровский Сергей", "3.25.2025", "414", "Питер"],
    [43, "Дубовицкая Ольга", "1.18.2025", "264", "Москва"],
    [44, "Дубовицкий Игорь", "1.18.2025", "276", "Москва"],
    [45, "Елсаков Сергей", "1.8.2025", "399", "Приозерск"],
    [46, "Елсакова Алена (юниор)", "1.8.2025", "400", "Приозерск"],
    [47, "Елсакова Оксана", "1.8.2025", "401", "Приозерск"],
    [48, "Земцов Сергей", "1.6.2025", "333", "Москва"],
    [49, "Зимин Михаил", "1.8.2025", "371", "Приозерск"],
    [50, "Зимина Светлана", "1.8.2025", "379", "Приозерск"],
    [51, "Зинкеев Георгий (юниор)", "1.8.2025", "378", "Приозерск"],
    [52, "Зубова Наталья", "1.19.2025", "299", "Москва"],
    [53, "Иванов Юрий", "1.8.2025", "364", "Приозерск"],
    [54, "Иванова Ольга", "1.8.2025", "383", "Приозерск"],
    [55, "Изместьев Алексей", "5.8.2025", "421", "Томск"],
    [56, "Казанцева Татьяна", "3.25.2025", "266", "Питер"],
    [57, "Кайтукова Фатима", "1.19.2025", "325", "Москва"],
    [58, "Кананыхина Светлана", "5.8.2025", "420", "Анапа"],
    [59, "Капов Иван", "3.1.2025", "372", "Приозерск"],
    [60, "Карепева Елена", "4.11.2025", "416", "Питер"],
    [61, "Каргашин Илья", "1.25.2025", "343", "Москва"],
    [62, "Кирдеева Надежда", "1.12.2025", "55", "Питер"],
    [63, "Кирменская Елена", "1.25.2025", "327", "Калуга"],
    [64, "Колесников Андрей", "1.26.2025", "104", "Москва"],
    [65, "Комаров Александр", "3.25.2025", "215", "Москва"],
    [66, "Кондратова Нина", "1.12.2025", "387", "Питер"],
    [67, "Коппа Нина", "1.2.2025", "360", "Москва"],
    [68, "Костяная Евгения", "2.19.2025", "377", "Новороссийск"],
    [69, "Кравцов Владимир", "1.25.2025", "334", "Москва"],
    [70, "Крошилов Александр", "1.31.2025", "357", "Питер"],
    [71, "Крошилова Ирина", "1.12.2025", "309", "Питер"],
    [72, "Кувакин Валерий", "1.12.2025", "376", "Питер"],
    [73, "Курбанова Маргарита", "1.25.2025", "66", "Москва"],
    [74, "Ли Александр", "1.18.2025", "277", "Москва"],
    [75, "Лукьянова Ирина", "2.1.2025", "356", "Москва"],
    [76, "Лухиши Абделхафидх", "3.11.2025", "369", "Москва"],
    [77, "Лютиков Александр", "3.25.2025", "94", "Москва"],
    [78, "Лямунов Никита", "1.12.2025", "120", "Питер"],
    [79, "Мельник Татьяна", "3.14.2025", "412", "Полярные Зори"],
    [80, "Мирошниченко Вера", "1.12.2025", "253", "Питер"],
    [81, "Мишин Дмитрий", "1.12.2025", "346", "Питер"],
    [82, "Мурашова Елена", "1.18.2025", "322", "Москва"],
    [83, "Ницинский Станислав", "1.25.2025", "174", "Москва"],
    [84, "Новиков Андрей", "1.8.2025", "366", "Приозерск"],
    [85, "Новиков Петр", "1.18.2025", "398", "Москва"],
    [86, "Орлова Таисия", "1.8.2025", "402", "Приозерск"],
    [87, "Осокин Евгений", "3.14.2025", "1", "Москва"],
    [88, "Павлова Ирина", "12.27.2024", "130", "Москва"],
    [89, "Пелевин Андрей", "1.8.2025", "363", "Приозерск"],
    [90, "Пелевина Наталия", "1.8.2025", "367", "Приозерск"],
    [91, "Петраков Игорь", "2.9.2025", "377", "Москва"],
    [92, "Петрушко Алексей", "1.18.2025", "296", "Москва"],
    [93, "Петрушко Юлия", "1.18.2025", "297", "Москва"],
    [94, "Пименова Татьяна", "1.12.2025", "280", "Питер"],
    [95, "Поляков Алексей", "1.18.2025", "335", "Москва"],
    [96, "Полякова Оксана", "1.18.2025", "344", "Москва"],
    [97, "Попов Виктор", "1.8.2025", "365", "Приозерск"],
    [98, "Розанова Юлия", "1.12.2025", "397", "Питер"],
    [99, "Савельев Игорь", "1.12.2025", "407", "Питер"],
    [100, "Савченко Елена", "3.11.2025", "265", "Москва"],
    [101, "Сафонов Сергей", "1.12.2025", "406", "Питер"],
    [102, "Сафонова Светлана", "1.12.2025", "350", "Питер"],
    [103, "Северов Михаил", "1.12.2025", "159", "Питер"],
    [104, "Склокина Ксения", "1.12.2025", "408", "Питер"],
    [105, "Скляр Светлана", "2.1.2025", "258", "Десногорск"],
    [106, "Смирнов Виктор", "1.12.2025", "351", "Питер"],
    [107, "Соколова Ольга", "1.8.2025", "373", "Приозерск"],
    [108, "Тарасов Константин", "1.6.2025", "403", "Москва"],
    [109, "Таратина Елена", "4.11.2025", "415", "Питер"],
    [110, "Таратин Артем (юниор)", "1.12.2025", "388", "Питер"],
    [111, "Тихонов Дмитрий", "1.18.2025", "21", "Москва"],
    [112, "Ткаченко Анна", "1.12.2025", "14", "Питер"],
    [113, "Трофимов Александр", "2.22.2025", "226", "Москва"],
    [114, "Трофимова Екатерина", "2.22.2025", "58", "Москва"],
    [115, "Трутнев Евгений", "1.25.2025", "336", "Калуга"],
    [116, "Федотов Николай", "1.12.2025", "285", "Питер"],
    [117, "Федотовский Олег", "1.25.2025", "358", "Калуга"],
    [118, "Филатов Андрей", "3.14.2025", "300", "Москва"],
    [119, "Хафизова Индира", "1.6.2025", "324", "Москва"],
    [120, "Хе Марина", "1.12.2025", "405", "Питер"],
    [121, "Царегородцев Александр", "1.25.2025", "368", "Калуга"],
    [122, "Чекмарева Татьяна", "1.12.2025", "347", "Питер"],
    [123, "Шапкин Константин", "1.18.2025", "353", "Москва"],
    [124, "Шевченко София", "5.8.2025", "418", "Анапа"],
    [125, "Шундрин Алексей", "1.25.2025", "328", "Калуга"],
    [126, "Шундрин Михаил", "1.25.2025", "286", "Калуга"],
    [127, "Энжольрас Жером", "3.25.2025", "225", "Москва"]
]


def create_excel_file():
    """Создаем Excel файл с лицензионными игроками"""
    
    # Создаем новый workbook
    wb = openpyxl.Workbook()
    ws = wb.active
    ws.title = "Лицензионные игроки 2025"
    
    # Заголовки колонок
    headers = ["№ п/п", "ФИО", "Дата", "№ лицензии", "Город"]
    
    # Записываем заголовки
    for col, header in enumerate(headers, 1):
        ws.cell(row=1, column=col, value=header)
    
    # Записываем данные игроков
    for row_num, player_data in enumerate(players_data, 2):  # Начинаем со 2-й строки
        for col, value in enumerate(player_data, 1):
            ws.cell(row=row_num, column=col, value=value)
    
    # Настраиваем ширину колонок для лучшего отображения
    column_widths = [8, 25, 12, 12, 20]  # № п/п, ФИО, Дата, № лицензии, Город
    for i, width in enumerate(column_widths, 1):
        ws.column_dimensions[openpyxl.utils.get_column_letter(i)].width = width
    
    # Устанавливаем стили для заголовков
    from openpyxl.styles import Font, PatternFill, Alignment
    
    header_font = Font(bold=True)
    header_fill = PatternFill(start_color="E6F3FF", end_color="E6F3FF", fill_type="solid")
    center_alignment = Alignment(horizontal="center", vertical="center")
    
    for col in range(1, len(headers) + 1):
        header_cell = ws.cell(row=1, column=col)
        header_cell.font = header_font
        header_cell.fill = header_fill
        header_cell.alignment = center_alignment
    
    # Центрируем данные в колонках № п/п, Дата и № лицензии
    for row in range(2, len(players_data) + 2):
        ws.cell(row=row, column=1).alignment = center_alignment  # № п/п
        ws.cell(row=row, column=3).alignment = center_alignment  # Дата
        ws.cell(row=row, column=4).alignment = center_alignment  # № лицензии
    
    # Добавляем границы для таблицы
    from openpyxl.styles import Border, Side
    
    thin_border = Border(
        left=Side(style='thin'),
        right=Side(style='thin'),
        top=Side(style='thin'),
        bottom=Side(style='thin')
    )
    
    for row in range(1, len(players_data) + 2):
        for col in range(1, len(headers) + 1):
            ws.cell(row=row, column=col).border = thin_border
    
    # Сохраняем файл
    filename = "/Users/afrikanova/projects/petanque/rate-scoring/Лицензионные_игроки_2025.xlsx"
    wb.save(filename)
    
    print(f"✅ Excel файл создан: {filename}")
    print(f"📊 Общее количество лицензионных игроков: {len(players_data)}")
    
    # Подсчитываем игроков по городам
    cities = {}
    for player in players_data:
        city = player[4]  # Город в 5-й колонке (индекс 4)
        cities[city] = cities.get(city, 0) + 1
    
    print("\n🏙️ Распределение по городам:")
    for city, count in sorted(cities.items(), key=lambda x: x[1], reverse=True):
        print(f"  {city}: {count} игрок(ов)")
    
    return filename


if __name__ == "__main__":
    print("🎾 Создание Excel файла лицензионных игроков петанка 2025")
    print("📅 Данные по состоянию на 01.07.2025 г.")
    print("🌐 Источник: https://petanque.ru/rfp/litsenzii/deystvuyushchie-litsenzii.php\n")
    
    filename = create_excel_file()
    print(f"\n✨ Готово! Файл можно использовать для импорта в систему рейтинга.")
